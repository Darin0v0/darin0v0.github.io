<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Moje Projekty — Portfolio</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px,1fr));
      gap: 20px;
      padding: 20px;
    }
    .project-card {
      border: 1px solid #444;
      padding: 16px;
      background: #111;
      color: #eee;
      text-align: center;
    }
    .project-card h3 {
      margin: 0 0 12px;
    }
    .project-card a {
      color: #0af;
      text-decoration: none;
      margin: 0 8px;
      display: inline-block;
    }
    .project-card img {
      max-width: 100%;
      height: auto;
      margin-bottom: 12px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Moje Projekty — Portfolio</h1>
    <p>Kliknij kartę, by zobaczyć demo lub kod źródłowy.</p>
  </header>
  <main>
    <div id="projectsContainer" class="projects-grid">
      <!-- Projekty zostaną dodane dynamicznie -->
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const GITHUB_USER = 'Darin0v0';
      const GITHUB_REPO = 'Darin0v0.github.io';
      const PROJECTS_PATH = 'projects/Portfolio';

      const projectsContainer = document.getElementById('projectsContainer');

      async function fetchProjectsList() {
        const url = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${PROJECTS_PATH}`;
        try {
          const resp = await fetch(url, { headers: { "Accept": "application/vnd.github+json" } });
          if (!resp.ok) {
            throw new Error(`GitHub API error: ${resp.status}`);
          }
          const data = await resp.json();
          const dirs = data.filter(item => item.type === 'dir');
          return dirs.map(d => d.name);
        } catch (err) {
          console.error('Błąd pobierania listy projektów:', err);
          projectsContainer.innerHTML = `<p>Nie udało się wczytać projektów.</p>`;
          return [];
        }
      }

      function createProjectCard(folderName) {
        const card = document.createElement('div');
        card.className = 'project-card';

        const title = document.createElement('h3');
        title.textContent = folderName.replace(/[-_]/g, ' ');
        card.appendChild(title);

        const img = document.createElement('img');
        img.src = `./projects/Portfolio/${folderName}/prew.jpg`;
        img.alt = folderName;
        img.onerror = () => { img.remove(); };
        card.appendChild(img);

        const demoLink = document.createElement('a');
        demoLink.href = `https://${GITHUB_USER}.github.io/projects/Portfolio/${folderName}/`;
        demoLink.target = '_blank';
        demoLink.rel = 'noopener noreferrer';
        demoLink.textContent = 'LIVE DEMO';
        card.appendChild(demoLink);

        const sourceLink = document.createElement('a');
        sourceLink.href = `https://github.com/${GITHUB_USER}/${GITHUB_REPO}/tree/main/projects/Portfolio/${folderName}`;
        sourceLink.target = '_blank';
        sourceLink.rel = 'noopener noreferrer';
        sourceLink.textContent = 'SOURCE CODE';
        card.appendChild(sourceLink);

        return card;
      }

      async function initProjects() {
        const folders = await fetchProjectsList();
        if (folders.length === 0) {
          projectsContainer.innerHTML = `<p>Brak projektów do pokazania.</p>`;
          return;
        }
        folders.forEach(folder => {
          const card = createProjectCard(folder);
          projectsContainer.appendChild(card);
        });
      }

      initProjects();
    });
  </script>
</body>
</html>
